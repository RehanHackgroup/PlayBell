<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin Panel - PlayBell</title>
  <style>
    body{
      margin:0;
      padding:0;
      background:radial-gradient(circle at top,#1a1a1a,#050505);
      font-family:Arial,sans-serif;
      min-height:100vh;
      color:#fff;
    }

    .top-bar{
      display:flex;
      justify-content:space-between;
      align-items:center;
      padding:10px 18px;
      background:rgba(5,5,5,0.95);
      border-bottom:1px solid #222;
    }

    .logo{
      font-weight:bold;
      color:#00ffcc;
      font-size:18px;
    }

    .nav-links a,.nav-links button{
      margin-left:10px;
      font-size:13px;
      color:#eee;
      background:none;
      border:none;
      cursor:pointer;
      text-decoration:none;
    }

    .nav-links button{
      padding:4px 10px;
      border-radius:6px;
      background:#d32f2f;
    }

    .nav-links button:hover{background:#b71c1c;}

    .container{
      max-width:950px;
      margin:25px auto;
      padding:0 12px;
    }

    .card{
      background:rgba(10,10,10,0.95);
      border-radius:14px;
      padding:18px;
      box-shadow:0 0 25px rgba(0,0,0,0.8);
      border:1px solid #222;
      margin-bottom:18px;
    }

    h3{
      margin:0 0 6px;
      color:#00ffcc;
    }

    .section-sub{
      font-size:13px;
      color:#aaa;
      margin-bottom:14px;
    }

    /* ✅ Inputs */
    input[type="text"], input[type="file"]{
      width:100%;
      padding:8px;
      border-radius:6px;
      border:none;
      outline:none;
      background:#1b1b1b;
      color:#fff;
      font-size:13px;
    }

    input:focus{box-shadow:0 0 0 1px #00ffcc;}

    /* ✅ Buttons */
    .btn{
      padding:8px 14px;
      border-radius:6px;
      border:none;
      cursor:pointer;
      font-size:13px;
    }

    .btn-main{
      background:#00ffcc;
      color:#000;
      font-weight:bold;
    }

    .btn-main:hover{background:#00e6b8;}

    .btn-small{
      background:#333;
      color:#fff;
      margin-left:4px;
    }

    .btn-small.danger{background:#d32f2f;}

    /* ✅ Blue custom upload button */
    .upload-btn{
      background:#2962ff;
      color:#fff;
      padding:6px 14px;
      border-radius:6px;
      font-size:12px;
      font-weight:bold;
      cursor:pointer;
      border:none;
      display:inline-block;
    }

    .upload-btn:hover{background:#1e4fd6;}

    /* ✅ Upload form layout */
    .admin-upload-form{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      align-items:center;
    }

    table{
      width:100%;
      border-collapse:collapse;
      font-size:13px;
      margin-top:10px;
    }

    th,td{
      border-bottom:1px solid #222;
      padding:8px;
      text-align:left;
    }

    th{
      color:#ccc;
      font-weight:bold;
    }
  </style>
</head>
<body>

<div class="top-bar">
  <div class="logo">PlayBell - Admin</div>
  <div class="nav-links">
    <a href="/songs">All Songs</a>
    <a href="/admin/requests">Song Requests</a>

    <% if (currentUser && currentUser.role === "superadmin") { %>
      <a href="/superadmin">Super Admin</a>
    <% } %>

    <a href="/change-password">Change Password</a>

    <form method="POST" action="/logout" style="display:inline;">
      <button type="submit">Logout</button>
    </form>
  </div>
</div>

<div class="container">

  <!-- ✅ ADD SONG -->
  <div class="card">
    <h3>Add New Song (MP3 Upload)</h3>
    <p class="section-sub">Upload MP3 with title and artist.</p>

    <form method="POST" action="/admin/add-song"
          enctype="multipart/form-data"
          class="admin-upload-form">

      <input type="text" name="title" placeholder="Song Title" required>
      <input type="text" name="artist" placeholder="Artist" required>

      <input type="file" name="mp3file" id="admin-file" hidden required>
      <label for="admin-file" class="upload-btn">UPLOAD</label>

      <span id="admin-file-name" style="font-size:11px;color:#aaa;">No file</span>

      <button type="submit" class="btn btn-main">ADD</button>
    </form>
  </div>

  <!-- ✅ MANAGE SONGS -->
  <div class="card">
    <h3>Manage Songs</h3>

    <table>
      <tr>
        <th>ID</th>
        <th>Title</th>
        <th>Artist</th>
        <th>Muted</th>
        <th>Actions</th>
      </tr>

      <% songs.forEach(function(song){ %>
        <tr>
          <td><%= song.id %></td>
          <td><%= song.title %></td>
          <td><%= song.artist %></td>
          <td><%= song.muted ? "Yes" : "No" %></td>
          <td>
            <form method="POST" action="/admin/toggle-mute" style="display:inline;">
              <input type="hidden" name="id" value="<%= song.id %>">
              <button class="btn btn-small"><%= song.muted ? "Unmute" : "Mute" %></button>
            </form>

            <form method="POST" action="/admin/delete-song"
                  style="display:inline;"
                  onsubmit="return confirm('Delete song <%= song.title %>?');">
              <input type="hidden" name="id" value="<%= song.id %>">
              <button class="btn btn-small danger">Delete</button>
            </form>
          </td>
        </tr>
      <% }) %>
    </table>
  </div>

</div>

<script>
  document.getElementById("admin-file").addEventListener("change", function(e){
    document.getElementById("admin-file-name").innerText =
      e.target.files[0]?.name || "No file";
  });
</script>

</body>
</html>
